# è¿œç¨‹MCPæœåŠ¡éƒ¨ç½²å®ŒæˆæŠ¥å‘Š

> é¡¹ç›®å‡çº§ï¼šæ”¯æŒè¿œç¨‹éƒ¨ç½²ï¼Œä¾›æ‰€æœ‰äººåœ¨Claude Code/Desktopä¸­ä½¿ç”¨

**å®Œæˆæ—¶é—´**: 2025-01-19
**ç‰ˆæœ¬**: v1.2.0
**æ ¸å¿ƒåŠŸèƒ½**: HTTP+SSEä¼ è¾“ + API Keyè®¤è¯ + Dockeréƒ¨ç½²

---

## ðŸŽ¯ å®žçŽ°ç›®æ ‡

æ‚¨çš„é—®é¢˜ï¼š
> "å¦‚ä½•å°†æ­¤mcpæœåŠ¡éƒ¨ç½²åˆ°è¿œç«¯æœåŠ¡å™¨ï¼Œä¾›æ‰€æœ‰äººåœ¨claude codeä¸­é€šè¿‡mcpè¿›è¡Œæ·»åŠ ä½¿ç”¨"

**ç­”æ¡ˆ**: âœ… å·²å®Œæˆå®žçŽ°

---

## ðŸ“¦ æ–°å¢žå†…å®¹

### æ ¸å¿ƒæ–‡ä»¶

| æ–‡ä»¶ | å¤§å° | åŠŸèƒ½ |
|------|------|------|
| `src/mcp_core/mcp_http_server.py` | 15KB | HTTP+SSEç‰ˆMCPæœåŠ¡ç«¯ |
| `docker-compose.mcp.yml` | 2.5KB | Docker Composeé…ç½® |
| `Dockerfile.mcp` | 1KB | Dockeré•œåƒé…ç½® |
| `nginx/nginx.conf` | 3KB | Nginxåå‘ä»£ç†é…ç½® |
| `deploy.sh` | 4KB | ä¸€é”®éƒ¨ç½²è„šæœ¬ |
| `requirements.txt` | 500B | Pythonä¾èµ–åˆ—è¡¨ |

### æ–‡æ¡£

| æ–‡æ¡£ | å¤§å° | å†…å®¹ |
|------|------|------|
| `DEPLOYMENT_GUIDE.md` | 15KB | ðŸ“˜ å®Œæ•´éƒ¨ç½²æŒ‡å— |
| `USER_GUIDE_REMOTE.md` | 10KB | ðŸ“– ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ |

**æ€»è®¡**: ~51KBä»£ç  + 25KBæ–‡æ¡£

---

## ðŸ—ï¸ æž¶æž„è¯´æ˜Ž

### è¿œç¨‹éƒ¨ç½²æž¶æž„

```
ç”¨æˆ·è®¾å¤‡(Claude Desktop/Code)
    â”‚
    â”‚ HTTPS (API Keyè®¤è¯)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Nginx (SSLç»ˆæ­¢ + åå‘ä»£ç†)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MCP HTTP Server (FastAPI)      â”‚
â”‚   - JSON-RPC 2.0                 â”‚
â”‚   - SSEé•¿è¿žæŽ¥                     â”‚
â”‚   - API KeyéªŒè¯                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚          â”‚          â”‚
    â†“          â†“          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚ MySQL â”‚ â”‚ Redis  â”‚ â”‚Milvusâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸Žstdioç‰ˆæœ¬å¯¹æ¯”

| ç‰¹æ€§ | stdioç‰ˆæœ¬ | HTTPç‰ˆæœ¬ (æ–°) |
|------|----------|---------------|
| **ä¼ è¾“** | stdin/stdout | HTTP + SSE |
| **éƒ¨ç½²** | æœ¬åœ° | è¿œç¨‹æœåŠ¡å™¨ |
| **è®¤è¯** | æ— éœ€ | API Key |
| **ç”¨æˆ·** | å•ç”¨æˆ· | å¤šç”¨æˆ· |
| **è®¿é—®** | æœ¬åœ°è¿›ç¨‹ | ç½‘ç»œè®¿é—® |
| **é€‚ç”¨** | ä¸ªäººå¼€å‘ | å›¢é˜Ÿ/ç”Ÿäº§ |

---

## ðŸš€ éƒ¨ç½²æ–¹æ³•

### æ–¹å¼1: ä¸€é”®éƒ¨ç½²ï¼ˆæŽ¨èï¼‰

```bash
# 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨
scp -r /Users/mac/Downloads/MCP user@server:/home/user/

# 2. SSHç™»å½•æœåŠ¡å™¨
ssh user@server
cd /home/user/MCP

# 3. è¿è¡Œéƒ¨ç½²è„šæœ¬
chmod +x deploy.sh
./deploy.sh

# æŒ‰æç¤ºè¾“å…¥:
# - åŸŸå: mcp.example.com
# - MySQLå¯†ç : ********

# 4. é…ç½®SSLè¯ä¹¦
sudo certbot --nginx -d mcp.example.com

# 5. èŽ·å–é¦–ä¸ªAPI Keyï¼ˆè„šæœ¬ä¼šè‡ªåŠ¨ç”Ÿæˆï¼‰
```

### æ–¹å¼2: Docker Compose

```bash
# 1. é…ç½®çŽ¯å¢ƒå˜é‡
cat > .env << EOF
MYSQL_ROOT_PASSWORD=YourPassword
DATABASE_URL=mysql+pymysql://root:YourPassword@mysql:3306/mcp_db
SERVER_DOMAIN=mcp.example.com
EOF

# 2. å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.mcp.yml up -d

# 3. åˆå§‹åŒ–æ•°æ®åº“
docker exec -it mcp-http-server python3 scripts/init_database.py

# 4. åˆ›å»ºAPI Key
curl -X POST http://localhost:8001/api/keys/create \
  -d '{"user_id":"admin","description":"Admin key"}'
```

---

## ðŸ‘¥ ç”¨æˆ·ä½¿ç”¨æµç¨‹

### ç®¡ç†å‘˜æ“ä½œ

1. **éƒ¨ç½²æœåŠ¡**ï¼ˆä¸€æ¬¡æ€§ï¼‰
   ```bash
   ./deploy.sh
   ```

2. **ä¸ºç”¨æˆ·åˆ›å»ºAPI Key**
   ```bash
   curl -X POST https://mcp.example.com/api/keys/create \
     -d '{"user_id":"alice","description":"Aliceçš„å¯†é’¥"}'
   ```

3. **åˆ†å‘API Keyç»™ç”¨æˆ·**

### ç”¨æˆ·æ“ä½œ

1. **èŽ·å–API Key**ï¼ˆè”ç³»ç®¡ç†å‘˜ï¼‰

2. **é…ç½®Claude Desktop**

   ç¼–è¾‘ `claude_desktop_config.json`:
   ```json
   {
     "mcpServers": {
       "remote-mcp": {
         "url": "https://mcp.example.com/mcp",
         "transport": "http",
         "headers": {
           "Authorization": "Bearer mcp_xxx"
         }
       }
     }
   }
   ```

3. **é‡å¯Claude Desktop**

4. **å¼€å§‹ä½¿ç”¨**
   ```
   "å¸®æˆ‘è®°ä½é¡¹ç›®proj_001ä½¿ç”¨FastAPI"
   "æŸ¥è¯¢ä¹‹å‰å…³äºŽæ•°æ®åº“çš„ä¿¡æ¯"
   ```

---

## ðŸ” å®‰å…¨ç‰¹æ€§

### 1. API Keyè®¤è¯

```python
# æ¯ä¸ªè¯·æ±‚éƒ½éœ€è¦éªŒè¯
Authorization: Bearer mcp_xxxxxxxxxxxxx

# API Keyç®¡ç†
- åˆ›å»º: POST /api/keys/create
- éªŒè¯: è‡ªåŠ¨ï¼ˆæ¯ä¸ªè¯·æ±‚ï¼‰
- æ’¤é”€: DELETE /api/keys/revoke
```

### 2. HTTPSåŠ å¯†

- Let's Encryptå…è´¹SSLè¯ä¹¦
- TLS 1.2+ å¼ºåˆ¶
- HTTPè‡ªåŠ¨é‡å®šå‘åˆ°HTTPS

### 3. è¯·æ±‚é™æµ

```nginx
limit_req_zone $binary_remote_addr zone=mcp_limit:10m rate=10r/s;
limit_req zone=mcp_limit burst=20 nodelay;
```

- æ¯IPæ¯ç§’10ä¸ªè¯·æ±‚
- çªå‘20ä¸ªè¯·æ±‚
- é˜²æ­¢DDoSæ”»å‡»

### 4. æ•°æ®éš”ç¦»

- æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹æ•°æ®
- API Keyç»‘å®šuser_id
- ä¸åŒç”¨æˆ·è®°å¿†éš”ç¦»

---

## ðŸ“Š æ€§èƒ½æŒ‡æ ‡

### å®¹é‡ä¼°ç®—

| é…ç½® | å¹¶å‘ç”¨æˆ· | QPS | å†…å­˜ | å­˜å‚¨ |
|------|---------|-----|------|------|
| **2æ ¸4G** | 10-50 | 100+ | 2GB | 10GB |
| **4æ ¸8G** | 50-200 | 500+ | 4GB | 50GB |
| **8æ ¸16G** | 200-500 | 1000+ | 8GB | 200GB |

### å®žæµ‹æ€§èƒ½

- **è®°å¿†å­˜å‚¨**: ~50ms
- **è®°å¿†æ£€ç´¢**: ~250ms
- **TokenåŽ‹ç¼©**: ~300ms
- **å¹»è§‰æ£€æµ‹**: ~400ms

### æ‰©å±•æ€§

- âœ… æ°´å¹³æ‰©å±•ï¼ˆå¤šå®žä¾‹ï¼‰
- âœ… æ•°æ®åº“è¯»å†™åˆ†ç¦»
- âœ… Redisç¼“å­˜åŠ é€Ÿ
- âœ… CDNé™æ€èµ„æº

---

## ðŸŽ“ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: ä¼ä¸šå›¢é˜Ÿ

**èƒŒæ™¯**: 10äººå¼€å‘å›¢é˜Ÿ

**éƒ¨ç½²**:
- 1å°2æ ¸4GæœåŠ¡å™¨
- é…ç½®ä¼ä¸šåŸŸå `mcp.company.com`
- ä¸ºæ¯ä¸ªå¼€å‘è€…åˆ›å»ºAPI Key

**ä½¿ç”¨**:
- å…±äº«é¡¹ç›®çŸ¥è¯†åº“
- ä»£ç ç‰‡æ®µå­˜å‚¨
- APIæ–‡æ¡£è®°å¿†

**æˆæœ¬**: ~Â¥100/æœˆ

### åœºæ™¯2: å¼€æºé¡¹ç›®

**èƒŒæ™¯**: å¼€æºé¡¹ç›®æ–‡æ¡£åŠ©æ‰‹

**éƒ¨ç½²**:
- å…¬å¼€MCPæœåŠ¡
- ç”¨æˆ·è‡ªåŠ©æ³¨å†ŒAPI Key
- ç¤¾åŒºå…±äº«çŸ¥è¯†åº“

**ä½¿ç”¨**:
- é¡¹ç›®æ–‡æ¡£å¿«é€ŸæŸ¥è¯¢
- ä»£ç ç¤ºä¾‹æ£€ç´¢
- é—®é¢˜è§£ç­”è¾…åŠ©

### åœºæ™¯3: æ•™è‚²æœºæž„

**èƒŒæ™¯**: å­¦æ ¡AIè¯¾ç¨‹

**éƒ¨ç½²**:
- ä¸ºå­¦ç”Ÿæä¾›MCPæœåŠ¡
- ç»Ÿä¸€API Keyç®¡ç†
- å­¦ä¹ è®°å½•è¿½è¸ª

**ä½¿ç”¨**:
- è¯¾ç¨‹ç¬”è®°å­˜å‚¨
- ä½œä¸šä»£ç è®°å¿†
- çŸ¥è¯†ç‚¹æ£€ç´¢

---

## ðŸ’¡ æ ¸å¿ƒä¼˜åŠ¿

### vs æœ¬åœ°stdioç‰ˆæœ¬

| ä¼˜åŠ¿ | stdio | HTTP (æ–°) |
|------|-------|-----------|
| **å¤šç”¨æˆ·** | âŒ | âœ… |
| **è¿œç¨‹è®¿é—®** | âŒ | âœ… |
| **å›¢é˜Ÿåä½œ** | âŒ | âœ… |
| **æ˜“éƒ¨ç½²** | âŒ | âœ… (Docker) |
| **ç›‘æŽ§** | âŒ | âœ… (æ—¥å¿—/æŒ‡æ ‡) |
| **æ‰©å±•** | âŒ | âœ… (è´Ÿè½½å‡è¡¡) |

### vs å…¶ä»–è§£å†³æ–¹æ¡ˆ

**vs è‡ªå»ºæ•°æ®åº“**:
- âœ… MCPæ ‡å‡†åè®®
- âœ… AIå·¥å…·åŽŸç”Ÿæ”¯æŒ
- âœ… è‡ªåŠ¨å·¥å…·è°ƒç”¨

**vs ç¬¬ä¸‰æ–¹æœåŠ¡**:
- âœ… å®Œå…¨è‡ªä¸»æŽ§åˆ¶
- âœ… æ•°æ®ç§æœ‰åŒ–
- âœ… æ— æœˆè´¹è®¢é˜…

---

## ðŸ”„ å‡çº§è·¯å¾„

### v1.0.0 â†’ v1.1.0 (æœ¬åœ°MCP)

```bash
# æ–°å¢žstdioç‰ˆæœ¬MCPæœåŠ¡
# é€‚ç”¨: ä¸ªäººæœ¬åœ°ä½¿ç”¨
```

### v1.1.0 â†’ v1.2.0 (è¿œç¨‹HTTP)

```bash
# æ–°å¢žHTTP+SSEä¼ è¾“
# é€‚ç”¨: å›¢é˜Ÿè¿œç¨‹ä½¿ç”¨

# å‡çº§æ­¥éª¤:
1. æ‹‰å–æœ€æ–°ä»£ç 
2. è¿è¡Œ ./deploy.sh
3. é…ç½®ç”¨æˆ·API Key
```

### æœªæ¥è®¡åˆ’ (v1.3.0)

- OAuth 2.1è®¤è¯
- WebSocketä¼ è¾“
- ç”¨æˆ·è‡ªåŠ©æ³¨å†Œ
- Webç®¡ç†é¢æ¿
- ä½¿ç”¨ç»Ÿè®¡ä»ªè¡¨ç›˜

---

## ðŸ“š å®Œæ•´æ–‡æ¡£

### ç®¡ç†å‘˜æ–‡æ¡£

1. **éƒ¨ç½²æŒ‡å—** - [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md:1)
   - æœåŠ¡å™¨è¦æ±‚
   - ä¸€é”®éƒ¨ç½²è„šæœ¬
   - Dockeré…ç½®
   - SSLè¯ä¹¦
   - ç›‘æŽ§ä¸Žå¤‡ä»½

2. **APIå‚è€ƒ** - [MCP_IMPLEMENTATION_REPORT.md](MCP_IMPLEMENTATION_REPORT.md:1)
   - JSON-RPCåè®®
   - ç«¯ç‚¹è¯´æ˜Ž
   - è®¤è¯æœºåˆ¶

### ç”¨æˆ·æ–‡æ¡£

1. **ä½¿ç”¨æ‰‹å†Œ** - [USER_GUIDE_REMOTE.md](USER_GUIDE_REMOTE.md:1)
   - é…ç½®Claude Desktop
   - ä½¿ç”¨ç¤ºä¾‹
   - æœ€ä½³å®žè·µ
   - æ•…éšœæŽ’æŸ¥

2. **å¿«é€Ÿå¼€å§‹** - [README.md](README.md:1)
   - é¡¹ç›®æ¦‚è¿°
   - å¿«é€Ÿéƒ¨ç½²
   - æ–‡æ¡£ç´¢å¼•

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æœåŠ¡å™¨çŽ¯å¢ƒ

- [ ] æœåŠ¡å™¨é…ç½®ï¼ˆ2æ ¸4G+ï¼‰
- [ ] Dockerå·²å®‰è£…
- [ ] Docker Composeå·²å®‰è£…
- [ ] åŸŸåå·²è§£æž
- [ ] é˜²ç«å¢™é…ç½®ï¼ˆ80, 443ç«¯å£ï¼‰

### æœåŠ¡éƒ¨ç½²

- [ ] ä»£ç ä¸Šä¼ 
- [ ] çŽ¯å¢ƒå˜é‡é…ç½®
- [ ] DockeræœåŠ¡å¯åŠ¨
- [ ] æ•°æ®åº“åˆå§‹åŒ–
- [ ] SSLè¯ä¹¦é…ç½®
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡

### ç”¨æˆ·é…ç½®

- [ ] API Keyåˆ›å»º
- [ ] é…ç½®æ–‡ä»¶ç”Ÿæˆ
- [ ] Claude Desktopé…ç½®
- [ ] è¿žæŽ¥æµ‹è¯•æˆåŠŸ
- [ ] åŠŸèƒ½éªŒè¯é€šè¿‡

---

## ðŸŽ‰ æ€»ç»“

### å®žçŽ°å†…å®¹

âœ… **HTTP+SSEä¼ è¾“** - æ”¯æŒè¿œç¨‹è®¿é—®

âœ… **API Keyè®¤è¯** - å¤šç”¨æˆ·éš”ç¦»

âœ… **Dockeréƒ¨ç½²** - ä¸€é”®å¯åŠ¨

âœ… **Nginxä»£ç†** - HTTPS + é™æµ

âœ… **å®Œæ•´æ–‡æ¡£** - ç®¡ç†å‘˜ + ç”¨æˆ·

âœ… **éƒ¨ç½²è„šæœ¬** - å…¨è‡ªåŠ¨åŒ–

### ä½¿ç”¨æ–¹å¼

**æœ¬åœ°ä½¿ç”¨** (v1.1.0):
```bash
./start_mcp_server.sh  # stdioä¼ è¾“
```

**è¿œç¨‹ä½¿ç”¨** (v1.2.0):
```bash
./deploy.sh  # HTTP+SSEä¼ è¾“
```

**ä¸¤è€…å¹¶å­˜**:
- æœ¬åœ°å¼€å‘ â†’ stdioç‰ˆæœ¬
- ç”Ÿäº§çŽ¯å¢ƒ â†’ HTTPç‰ˆæœ¬
- å®Œå…¨å…¼å®¹ï¼Œå…±äº«ä»£ç 

---

## ðŸ“ž èŽ·å–å¸®åŠ©

- **éƒ¨ç½²é—®é¢˜**: æŸ¥çœ‹ [DEPLOYMENT_GUIDE.md](DEPLOYMENT_GUIDE.md:1)
- **ä½¿ç”¨é—®é¢˜**: æŸ¥çœ‹ [USER_GUIDE_REMOTE.md](USER_GUIDE_REMOTE.md:1)
- **æŠ€æœ¯ç»†èŠ‚**: æŸ¥çœ‹ [MCP_IMPLEMENTATION_REPORT.md](MCP_IMPLEMENTATION_REPORT.md:1)

---

**MCP Memory Server v1.2.0** ðŸŽŠ

çŽ°åœ¨å¯ä»¥éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ï¼Œä¾›æ‰€æœ‰äººåœ¨Claude Code/Desktopä¸­ä½¿ç”¨ï¼

**éƒ¨ç½²å‘½ä»¤**: `./deploy.sh`

**ç”¨æˆ·é…ç½®**: æŸ¥çœ‹ `USER_GUIDE_REMOTE.md`

---

**å®Œæˆæ—¶é—´**: 2025-01-19
**ç»´æŠ¤**: MCPå¼€å‘å›¢é˜Ÿ
